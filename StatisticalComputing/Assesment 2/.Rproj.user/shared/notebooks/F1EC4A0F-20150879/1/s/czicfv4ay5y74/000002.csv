"0","#For the gradient boosting models a function 'Boost_validation' was created to perform the validation"
"0","Bosst_validation<-function(max_depth_options,data_train){"
"0","  folds <- NULL"
"0","  best_error <- Inf"
"0","  best_md <- 0"
"0","  best_nrounds <- 0"
"0","  for (md in max_depth_options) {"
"0","    cat(""Trying maximum depth of"", md, ""...\n"")"
"0","    xgb_cv <- xgb.cv(data = as.matrix(data_train), label = dta$UNITS, "
"0","                            nfold = 5, nrounds = 100, max_depth = md, "
"0","                            folds = folds, verbose = FALSE)"
"0","    if (is.null(folds)) {"
"0","      folds <- xgb_cv$folds"
"0","    }"
"0","    trial_error <- min(xgb_cv$evaluation_log$test_rmse_mean)"
"0","    if (trial_error < best_error) {"
"0","      best_error <- trial_error"
"0","      best_md <- md"
"0","      best_nrounds <- which.min(xgb_cv$evaluation_log$test_rmse_mean)"
"0","    }"
"0","  }"
"0","  cat(""Hyperparameter selection: best nrounds is"", best_nrounds, "
"0","    ""and best maximum depth is"", best_md, ""\n"")"
"0","  return(c(best_md,best_nrounds))"
"0","}"
"0",""
