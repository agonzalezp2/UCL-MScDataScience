"0",""
"0","library(MASS)"
"2","
Attaching package: ‘MASS’

"
"2","The following object is masked from ‘package:dplyr’:

    select

"
"0","negbin_model <- glm.nb(UNITS~  BASE_PRICE+PRICE+UPC+DISCOUNT+STORE_GROUP+WEEK_YEAR+TPR_ONLY+FEATURE*DISPLAY+DISPLAY*DISCOUNT, data = dta_GLM)"
"0",""
"0","#Analisis"
"0","summary(negbin_model)"
"1","
Call:
"
"1",""
"1","glm.nb(formula = UNITS ~ BASE_PRICE + PRICE + UPC + DISCOUNT + 
    STORE_GROUP + WEEK_YEAR + TPR_ONLY + FEATURE * DISPLAY + 
    DISPLAY * DISCOUNT, data = dta_GLM, init.theta = 5.469083521, 
    link = log)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-3.3404  "
"1","-0.8240  "
"1","-0.1700  "
"1"," 0.4986  "
"1"," 3.5936  "
"1","
"
"1","
Coefficients:
"
"1","                 "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)      "
"1","  3.569004"
"1","   0.064111"
"1","  55.670"
"1","  < 2e-16"
"1"," ***"
"1","
BASE_PRICE       "
"1"," -0.248115"
"1","   0.051630"
"1","  -4.806"
"1"," 1.54e-06"
"1"," ***"
"1","
PRICE            "
"1"," -0.222865"
"1","   0.049034"
"1","  -4.545"
"1"," 5.49e-06"
"1"," ***"
"1","
UPC1111087396    "
"1","  0.002391"
"1","   0.023251"
"1","   0.103"
"1"," 0.918087"
"1","    "
"1","
UPC1111087398    "
"1","  0.214325"
"1","   0.022884"
"1","   9.366"
"1","  < 2e-16"
"1"," ***"
"1","
UPC2066200530    "
"1","  0.541490"
"1","   0.044771"
"1","  12.095"
"1","  < 2e-16"
"1"," ***"
"1","
UPC2066200531    "
"1","  0.506225"
"1","   0.048062"
"1","  10.533"
"1","  < 2e-16"
"1"," ***"
"1","
UPC2066200532    "
"1","  0.421720"
"1","   0.054455"
"1","   7.744"
"1"," 9.60e-15"
"1"," ***"
"1","
UPC7192100336    "
"1","  0.909992"
"1","   0.042469"
"1","  21.427"
"1","  < 2e-16"
"1"," ***"
"1","
UPC7192100337    "
"1","  1.213994"
"1","   0.042456"
"1","  28.594"
"1","  < 2e-16"
"1"," ***"
"1","
UPC7192100339    "
"1","  1.526140"
"1","   0.042147"
"1","  36.210"
"1","  < 2e-16"
"1"," ***"
"1","
UPC7218063052    "
"1","  0.576882"
"1","   0.046521"
"1","  12.400"
"1","  < 2e-16"
"1"," ***"
"1","
UPC7218063979    "
"1","  0.479275"
"1","   0.046688"
"1","  10.265"
"1","  < 2e-16"
"1"," ***"
"1","
UPC7218063983    "
"1","  0.442880"
"1","   0.047661"
"1","   9.292"
"1","  < 2e-16"
"1"," ***"
"1","
DISCOUNT         "
"1","  2.380064"
"1","   0.372440"
"1","   6.390"
"1"," 1.65e-10"
"1"," ***"
"1","
STORE_GROUP3     "
"1","  0.177863"
"1","   0.027500"
"1","   6.468"
"1"," 9.94e-11"
"1"," ***"
"1","
STORE_GROUP4     "
"1","  0.280968"
"1","   0.027898"
"1","  10.071"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP5     "
"1","  0.415834"
"1","   0.028432"
"1","  14.626"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP6     "
"1","  0.516925"
"1","   0.031464"
"1","  16.429"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP7     "
"1","  0.591000"
"1","   0.030127"
"1","  19.617"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP8     "
"1","  0.695824"
"1","   0.027238"
"1","  25.546"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP9     "
"1","  0.806827"
"1","   0.028408"
"1","  28.401"
"1","  < 2e-16"
"1"," ***"
"1","
STORE_GROUP10    "
"1","  1.012683"
"1","   0.027704"
"1","  36.553"
"1","  < 2e-16"
"1"," ***"
"1","
WEEK_YEAR2       "
"1","  0.210052"
"1","   0.056319"
"1","   3.730"
"1"," 0.000192"
"1"," ***"
"1","
WEEK_YEAR3       "
"1","  0.051771"
"1","   0.054128"
"1","   0.956"
"1"," 0.338839"
"1","    "
"1","
WEEK_YEAR4       "
"1"," -0.331501"
"1","   0.056866"
"1","  -5.830"
"1"," 5.56e-09"
"1"," ***"
"1","
WEEK_YEAR5       "
"1","  0.034513"
"1","   0.054819"
"1","   0.630"
"1"," 0.528968"
"1","    "
"1","
WEEK_YEAR6       "
"1","  0.152312"
"1","   0.054760"
"1","   2.781"
"1"," 0.005412"
"1"," ** "
"1","
WEEK_YEAR7       "
"1"," -0.005997"
"1","   0.054715"
"1","  -0.110"
"1"," 0.912728"
"1","    "
"1","
WEEK_YEAR8       "
"1","  0.055020"
"1","   0.057122"
"1","   0.963"
"1"," 0.335451"
"1","    "
"1","
WEEK_YEAR9       "
"1"," -0.087822"
"1","   0.056387"
"1","  -1.557"
"1"," 0.119359"
"1","    "
"1","
WEEK_YEAR10      "
"1"," -0.002849"
"1","   0.053205"
"1","  -0.054"
"1"," 0.957295"
"1","    "
"1","
WEEK_YEAR11      "
"1"," -0.122013"
"1","   0.055364"
"1","  -2.204"
"1"," 0.027537"
"1"," *  "
"1","
WEEK_YEAR12      "
"1"," -0.189080"
"1","   0.052810"
"1","  -3.580"
"1"," 0.000343"
"1"," ***"
"1","
WEEK_YEAR13      "
"1"," -0.256519"
"1","   0.054962"
"1","  -4.667"
"1"," 3.05e-06"
"1"," ***"
"1","
WEEK_YEAR14      "
"1"," -0.181643"
"1","   0.053822"
"1","  -3.375"
"1"," 0.000738"
"1"," ***"
"1","
WEEK_YEAR15      "
"1"," -0.071325"
"1","   0.055713"
"1","  -1.280"
"1"," 0.200467"
"1","    "
"1","
WEEK_YEAR16      "
"1"," -0.069220"
"1","   0.056111"
"1","  -1.234"
"1"," 0.217341"
"1","    "
"1","
WEEK_YEAR17      "
"1"," -0.083596"
"1","   0.054663"
"1","  -1.529"
"1"," 0.126190"
"1","    "
"1","
WEEK_YEAR18      "
"1","  0.004746"
"1","   0.051753"
"1","   0.092"
"1"," 0.926934"
"1","    "
"1","
WEEK_YEAR19      "
"1","  0.059896"
"1","   0.053133"
"1","   1.127"
"1"," 0.259620"
"1","    "
"1","
WEEK_YEAR20      "
"1"," -0.059540"
"1","   0.053741"
"1","  -1.108"
"1"," 0.267905"
"1","    "
"1","
WEEK_YEAR21      "
"1"," -0.310396"
"1","   0.057042"
"1","  -5.441"
"1"," 5.28e-08"
"1"," ***"
"1","
WEEK_YEAR22      "
"1"," -0.320492"
"1","   0.054857"
"1","  -5.842"
"1"," 5.15e-09"
"1"," ***"
"1","
WEEK_YEAR23      "
"1"," -0.009157"
"1","   0.055332"
"1","  -0.165"
"1"," 0.868557"
"1","    "
"1","
WEEK_YEAR24      "
"1"," -0.039745"
"1","   0.053435"
"1","  -0.744"
"1"," 0.457002"
"1","    "
"1","
WEEK_YEAR25      "
"1"," -0.178221"
"1","   0.054145"
"1","  -3.292"
"1"," 0.000996"
"1"," ***"
"1","
WEEK_YEAR26      "
"1"," -0.169803"
"1","   0.054864"
"1","  -3.095"
"1"," 0.001968"
"1"," ** "
"1","
WEEK_YEAR27      "
"1"," -0.247738"
"1","   0.054600"
"1","  -4.537"
"1"," 5.70e-06"
"1"," ***"
"1","
WEEK_YEAR28      "
"1"," -0.148839"
"1","   0.052203"
"1","  -2.851"
"1"," 0.004356"
"1"," ** "
"1","
WEEK_YEAR29      "
"1"," -0.079178"
"1","   0.056396"
"1","  -1.404"
"1"," 0.160331"
"1","    "
"1","
WEEK_YEAR30      "
"1"," -0.161461"
"1","   0.054767"
"1","  -2.948"
"1"," 0.003197"
"1"," ** "
"1","
WEEK_YEAR31      "
"1"," -0.139680"
"1","   0.056936"
"1","  -2.453"
"1"," 0.014156"
"1"," *  "
"1","
WEEK_YEAR32      "
"1"," -0.046733"
"1","   0.055125"
"1","  -0.848"
"1"," 0.396571"
"1","    "
"1","
WEEK_YEAR33      "
"1"," -0.053801"
"1","   0.055251"
"1","  -0.974"
"1"," 0.330177"
"1","    "
"1","
WEEK_YEAR34      "
"1"," -0.205651"
"1","   0.054607"
"1","  -3.766"
"1"," 0.000166"
"1"," ***"
"1","
WEEK_YEAR35      "
"1"," -0.230546"
"1","   0.056107"
"1","  -4.109"
"1"," 3.97e-05"
"1"," ***"
"1","
WEEK_YEAR36      "
"1"," -0.097382"
"1","   0.054153"
"1","  -1.798"
"1"," 0.072133"
"1"," .  "
"1","
WEEK_YEAR37      "
"1","  0.072820"
"1","   0.054381"
"1","   1.339"
"1"," 0.180543"
"1","    "
"1","
WEEK_YEAR38      "
"1"," -0.064197"
"1","   0.053613"
"1","  -1.197"
"1"," 0.231146"
"1","    "
"1","
WEEK_YEAR39      "
"1"," -0.176283"
"1","   0.055061"
"1","  -3.202"
"1"," 0.001367"
"1"," ** "
"1","
WEEK_YEAR40      "
"1"," -0.200233"
"1","   0.056172"
"1","  -3.565"
"1"," 0.000364"
"1"," ***"
"1","
WEEK_YEAR41      "
"1"," -0.134505"
"1","   0.052060"
"1","  -2.584"
"1"," 0.009776"
"1"," ** "
"1","
WEEK_YEAR42      "
"1"," -0.046404"
"1","   0.053584"
"1","  -0.866"
"1"," 0.386492"
"1","    "
"1","
WEEK_YEAR43      "
"1"," -0.170641"
"1","   0.055866"
"1","  -3.054"
"1"," 0.002255"
"1"," ** "
"1","
WEEK_YEAR44      "
"1"," -0.165034"
"1","   0.054215"
"1","  -3.044"
"1"," 0.002334"
"1"," ** "
"1","
WEEK_YEAR45      "
"1","  0.042741"
"1","   0.053210"
"1","   0.803"
"1"," 0.421827"
"1","    "
"1","
WEEK_YEAR46      "
"1","  0.033295"
"1","   0.053048"
"1","   0.628"
"1"," 0.530244"
"1","    "
"1","
WEEK_YEAR47      "
"1"," -0.118263"
"1","   0.052866"
"1","  -2.237"
"1"," 0.025284"
"1"," *  "
"1","
WEEK_YEAR48      "
"1"," -0.238346"
"1","   0.056194"
"1","  -4.241"
"1"," 2.22e-05"
"1"," ***"
"1","
WEEK_YEAR49      "
"1","  0.271624"
"1","   0.053204"
"1","   5.105"
"1"," 3.30e-07"
"1"," ***"
"1","
WEEK_YEAR50      "
"1","  0.048109"
"1","   0.051342"
"1","   0.937"
"1"," 0.348749"
"1","    "
"1","
WEEK_YEAR51      "
"1","  0.072480"
"1","   0.053379"
"1","   1.358"
"1"," 0.174520"
"1","    "
"1","
WEEK_YEAR52      "
"1"," -0.155848"
"1","   0.054796"
"1","  -2.844"
"1"," 0.004453"
"1"," ** "
"1","
TPR_ONLY1        "
"1"," -0.198996"
"1","   0.037366"
"1","  -5.326"
"1"," 1.01e-07"
"1"," ***"
"1","
FEATURE1         "
"1","  0.150284"
"1","   0.039001"
"1","   3.853"
"1"," 0.000117"
"1"," ***"
"1","
DISPLAY1         "
"1","  0.398674"
"1","   0.029014"
"1","  13.741"
"1","  < 2e-16"
"1"," ***"
"1","
FEATURE1:DISPLAY1"
"1"," -0.066178"
"1","   0.047758"
"1","  -1.386"
"1"," 0.165837"
"1","    "
"1","
DISCOUNT:DISPLAY1"
"1"," -0.107566"
"1","   0.171229"
"1","  -0.628"
"1"," 0.529874"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","Negative Binomial(5.4691)"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 31359  on 9981  degrees of freedom
"
"1",""
"1","Residual deviance: 10146  on 9903  degrees of freedom
"
"1","AIC: "
"1",""
"1","59457"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","1"
"1",""
"1","
"
"1","
"
"1","
              Theta: "
"1"," "
"1","5.469"
"1"," "
"1","
          Std. Err.: "
"1"," "
"1","0.124"
"1"," "
"1","
"
"1","
 2 x log-likelihood: "
"1"," "
"1","-59296.998"
"1"," "
"1","
"
"0","anova(negbin_model, test =""Chi"") # as we know the dispersion paramter we use Chi"
"2","tests made without re-estimating 'theta'"
"1","Analysis of Deviance Table

Model: Negative Binomial(5.4691), link: log

Response: UNITS

Terms added sequentially (first to last)

"
"1","
"
"1","                "
"1"," Df"
"1"," Deviance"
"1"," Resid. Df"
"1"," Resid. Dev"
"1","  Pr(>Chi)"
"1","    "
"1","
NULL            "
"1","   "
"1","         "
"1","      9981"
"1","      31359"
"1","          "
"1","    "
"1","
BASE_PRICE      "
"1","  1"
"1","     77.9"
"1","      9980"
"1","      31281"
"1"," < 2.2e-16"
"1"," ***"
"1","
PRICE           "
"1","  1"
"1","  11277.1"
"1","      9979"
"1","      20004"
"1"," < 2.2e-16"
"1"," ***"
"1","
UPC             "
"1"," 11"
"1","   4996.5"
"1","      9968"
"1","      15007"
"1"," < 2.2e-16"
"1"," ***"
"1","
DISCOUNT        "
"1","  1"
"1","    209.3"
"1","      9967"
"1","      14798"
"1"," < 2.2e-16"
"1"," ***"
"1","
STORE_GROUP     "
"1","  8"
"1","   3158.8"
"1","      9959"
"1","      11639"
"1"," < 2.2e-16"
"1"," ***"
"1","
WEEK_YEAR       "
"1"," 51"
"1","    674.0"
"1","      9908"
"1","      10965"
"1"," < 2.2e-16"
"1"," ***"
"1","
TPR_ONLY        "
"1","  1"
"1","    413.5"
"1","      9907"
"1","      10551"
"1"," < 2.2e-16"
"1"," ***"
"1","
FEATURE         "
"1","  1"
"1","     43.4"
"1","      9906"
"1","      10508"
"1"," 4.521e-11"
"1"," ***"
"1","
DISPLAY         "
"1","  1"
"1","    355.6"
"1","      9905"
"1","      10152"
"1"," < 2.2e-16"
"1"," ***"
"1","
FEATURE:DISPLAY "
"1","  1"
"1","      5.8"
"1","      9904"
"1","      10147"
"1","   0.01598"
"1"," *  "
"1","
DISCOUNT:DISPLAY"
"1","  1"
"1","      0.4"
"1","      9903"
"1","      10146"
"1","   0.52782"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1"
"1","
"
"0","drop1(negbin_model)"
"1","Single term deletions"
"1","
"
"1","
Model:"
"1","
"
"1","UNITS ~ BASE_PRICE + PRICE + UPC + DISCOUNT + STORE_GROUP + WEEK_YEAR + "
"1","
"
"1","    TPR_ONLY + FEATURE * DISPLAY + DISPLAY * DISCOUNT"
"1","
"
"1","                "
"1"," Df"
"1"," Deviance"
"1","   AIC"
"1","
<none>          "
"1","   "
"1","    10146"
"1"," 59455"
"1","
BASE_PRICE      "
"1","  1"
"1","    10170"
"1"," 59476"
"1","
PRICE           "
"1","  1"
"1","    10167"
"1"," 59474"
"1","
UPC             "
"1"," 11"
"1","    14537"
"1"," 63824"
"1","
STORE_GROUP     "
"1","  8"
"1","    12971"
"1"," 62264"
"1","
WEEK_YEAR       "
"1"," 51"
"1","    10681"
"1"," 59888"
"1","
TPR_ONLY        "
"1","  1"
"1","    10175"
"1"," 59481"
"1","
FEATURE:DISPLAY "
"1","  1"
"1","    10148"
"1"," 59455"
"1","
DISCOUNT:DISPLAY"
"1","  1"
"1","    10147"
"1"," 59453"
"1","
"
"0","plot(negbin_model)"
